<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Index - webdataset</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Index";
        var mkdocs_page_input_path = "examples/webdataset/index.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> webdataset
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">README</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../webdataset/">WebDataset</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../wids/">WIDS</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../FAQ/">FAQ</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >webdataset</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Index</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="wds-notes/">Wds notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="generate-text-dataset/">Dataset Generation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="tesseract-wds/">Tesseract wds</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="train-resnet50-wds/">Resnet 50 Training on (Fake)Imagenet with WebDataset</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="train-resnet50-multiray-wds/">WebDataset + Distributed PyTorch Training</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="train-ocr-errors-hf/">Fine Tuning LLM with Huggingface and WebDataset</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="mi-images/">Mini Imagenet Generation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="mi-prompts/">Mini Imagenet Generation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="column-store/">Using WebDataset as a Column Store</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >wids</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../wids/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../wids/train-resnet50-wids/">Train resnet50 wids</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../wids/train-resnet50-multiray-wids/">WebIndexedDataset + Distributed PyTorch Training</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">webdataset</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Examples</li>
          <li class="breadcrumb-item">webdataset</li>
      <li class="breadcrumb-item active">Index</li>
    <li class="wy-breadcrumbs-aside">
          <a href="http://github.com/webdataset/webdataset/edit/master/docs/examples/webdataset/index.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h3 id="tesseract-wds">Tesseract Wds</h3>
<p><a href="./tesseract-wds">Tesseract Wds</a></p>
<p>The notebook demonstrates how to process a large dataset of PDF files stored in
shards using the <code>webdataset</code> library. It illustrates the conversion of PDFs to
JPEG images and the subsequent OCR processing with Tesseract, showcasing the use
of <code>WebDataset</code> for reading and <code>TarWriter</code> for writing datasets. The notebook
also exemplifies parallel processing of shards with Ray, highlighting the
library's capability to handle large-scale OCR tasks efficiently.</p>
<h3 id="column-store">Column Store</h3>
<p><a href="./column-store">Column Store</a></p>
<p>The notebook demonstrates how to use the <code>WebDataset</code> library to handle datasets
that are split not only by rows but also by columns, by adding an additional
column from a separate dataset to the main dataset using a custom <code>add_column</code>
function. It shows how to use the <code>__url__</code> field to load additional data and
ensure the keys match between the main and additional data. The notebook also
introduces a simpler approach using the <code>wids</code> library with a <code>CombinedDataset</code>
class to combine two datasets, ensuring they have the same length and merging
their contents by index.</p>
<h3 id="generate-text-dataset">Generate Text Dataset</h3>
<p><a href="./generate-text-dataset">Generate Text Dataset</a></p>
<p>The notebook demonstrates the use of the <code>webdataset</code> library for generating and
storing synthetic text data in a sharded TAR format, which is suitable for
large-scale machine learning tasks. It uses the <code>TarWriter</code> class to create
shards containing text samples generated by GPT-2, and includes functions for
checking the existence of and uploading these shards to cloud storage. The
notebook also shows how to parallelize the shard generation and upload process
using Ray.</p>
<h3 id="mi-prompts">Mi Prompts</h3>
<p><a href="./mi-prompts">Mi Prompts</a></p>
<p>The notebook outlines the process of generating a Mini ImageNet dataset using a
text generation model (<code>TextGenerationModel</code>) and a caption generator
(<code>CaptionGenerator</code>). It utilizes the <code>webdataset</code> library to handle the dataset
creation and shuffling, specifically using classes like <code>TarWriter</code> for writing
shards and <code>read_webdataset</code> and <code>write_webdataset</code> functions for reading and
shuffling the dataset shards. The notebook demonstrates parallelization with Ray
to scale up the generation process across multiple GPUs and the use of
<code>webdataset</code> for managing large-scale image-caption datasets.</p>
<h3 id="train-resnet50-multiray-wds">Train Resnet50 Multiray Wds</h3>
<p><a href="./train-resnet50-multiray-wds">Train Resnet50 Multiray Wds</a></p>
<p>The notebook demonstrates how to use the <code>WebDataset</code> library for distributed
training with PyTorch's <code>DistributedDataParallel</code>. It focuses on creating data
loaders for streaming data directly from cloud storage for training deep
learning models, specifically using the <code>WebDataset</code>, <code>WebLoader</code>, and
<code>IterableDataset</code> classes from the <code>webdataset</code> library. The notebook also shows
how to integrate this setup with Ray for easy distributed training across
multiple GPUs.</p>
<h3 id="train-resnet50-wds">Train Resnet50 Wds</h3>
<p><a href="./train-resnet50-wds">Train Resnet50 Wds</a></p>
<p>The notebook demonstrates how to use the <code>webdataset</code> library for training a
ResNet50 model on a large-scale image dataset, specifically a fake version of
ImageNet, by streaming data directly from cloud storage. It showcases the
construction of a data loader using <code>WebDataset</code>, <code>WebLoader</code>, and various
transformations and shuffling methods provided by the library to prepare the
data for training. The notebook also includes a typical PyTorch training loop,
illustrating how the <code>webdataset</code> library integrates with PyTorch's training
pipeline.</p>
<h3 id="wds-notes">Wds Notes</h3>
<p><a href="./wds-notes">Wds Notes</a></p>
<p>The notebook provides an overview and tutorial on how to use the <code>webdataset</code>
library, which is a PyTorch <code>IterableDataset</code> for handling large-scale datasets
stored in web-friendly formats like tar files. It demonstrates how to read and
process data from such datasets, including shuffling, decoding, and
preprocessing for deep learning applications. The notebook showcases the use of
classes like <code>WebDataset</code>, <code>DataPipeline</code>, and <code>TarWriter</code> from the <code>webdataset</code>
library, illustrating how to create efficient I/O pipelines for training models
with large datasets that can be read from local disk or cloud storage.</p>
<h3 id="mi-images">Mi Images</h3>
<p><a href="./mi-images">Mi Images</a></p>
<p>The notebook demonstrates the use of the <code>webdataset</code> library to create a mini
ImageNet-like dataset by generating images from textual prompts using a stable
diffusion model. It showcases the <code>WebDataset</code> class for reading and writing
dataset shards and the <code>TarWriter</code> class for outputting transformed data. The
notebook also illustrates parallel processing with Ray to distribute the image
rendering workload across multiple GPUs, utilizing the <code>ActorPool</code> class for
managing a pool of actors.</p>
<h3 id="train-ocr-errors-hf">Train Ocr Errors Hf</h3>
<p><a href="./train-ocr-errors-hf">Train Ocr Errors Hf</a></p>
<p>The notebook demonstrates the use of the <code>WebDataset</code> library, specifically the
<code>ShardListDataset</code> and <code>ShardedSampler</code> classes, for efficient remote data
access and loading in the context of fine-tuning a Huggingface large language
model. It highlights how training data can be incrementally downloaded and
cached locally, and how a custom sampler can be employed to optimize the data
retrieval process from shards. The notebook also showcases the integration of
<code>WebDataset</code> with Huggingface's training loop, including the use of adapters for
model fine-tuning.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../FAQ/" class="btn btn-neutral float-left" title="FAQ"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="wds-notes/" class="btn btn-neutral float-right" title="Wds notes">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="http://github.com/webdataset/webdataset" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../FAQ/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="wds-notes/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
